{"posts":[{"title":"Typescript之封装Axios","content":"直接上代码安装依赖yarnaddaxios#或者npminstallaxios-SEncapsulation//config/index.tsexportdefault{api:{devApiBaseUrl:'/',//开发环境baseurlproApiBaseUrl:'/api/v1'//生产环境baseurl}}//utils/request.tsimportaxios,{AxiosInstance,AxiosRequestConfig,AxiosPromise,AxiosResponse}from'axios'importconfigfrom'@/config'const{api:{devApiBaseUrl,proApiBaseUrl}}=configconstapiBaseUrl=process.env.NODE_ENV==='production'?proApiBaseUrl:devApiBaseUrl//修改默认的content-typeaxios.defaults.headers.post['Content-Type']='application/x-www-form-urlencoded'/***统一返回的数据格式,根据具体业务修改*/exportinterfaceResponseData{code:numbermsg:stringdata?:any}classHttpRequest{constructor(publicbaseUrl:string=apiBaseUrl){this.baseUrl=baseUrl}publicrequest(options:AxiosRequestConfig):AxiosPromise{constinstance:AxiosInstance=axios.create()options=this.mergeConfig(options)this.interceptors(instance,options.url)returninstance(options)}/***配置拦截器*@paraminstance*@paramurl*/privateinterceptors(instance:AxiosInstance,url?:string){instance.interceptors.request.use((config:AxiosRequestConfig)=&gt;{//可以在这配置token请求头returnconfig},error=&gt;Promise.reject(error))instance.interceptors.response.use((res:AxiosResponse)=&gt;{const{data}=resconst{code,msg}=data//这里设置返回状态码为0表示成功,请根据具体业务修改if(code!==0){//TODO使用消息窗提示错误console.error(msg)}returnres},error=&gt;Promise.reject(error))}/***合并基础配置*@paramoptions*/privatemergeConfig(options:AxiosRequestConfig):AxiosRequestConfig{returnObject.assign({baseURL:this.baseUrl},options)}}exportdefaultHttpRequestHowtouse//api/index.tsimportHttpRequestfrom&quot;@/utils/request&quot;export*from'@/utils/request'exportdefaultnewHttpRequest()//api/user.tsimportaxios,{ResponseData}from'./index'import{AxiosPromise}from'axios'interfaceLoginReqArgInterface{username:stringpassword:number|string}//传入泛型变量ResponseData,可以在操作返回结果集时,获得代码提示exportconstloginApi=(data:LoginReqArgInterface):AxiosPromise&lt;ResponseData&gt;=&gt;{returnaxios.request({url:'/user/login',data,method:'POST'})}","link":"https://blog.yguilai.com/post/ojQKZXlfE/"},{"title":"Typescript之tsconfig.json配置","content":"tsconfig.json的可配置项{&quot;compileOnSave&quot;:true,&quot;files&quot;:[],&quot;include&quot;:[],&quot;exclude&quot;:[],&quot;extends&quot;:&quot;&quot;,&quot;compilerOptions&quot;:{}}compileOnSavecompileOnSave的值是true或false.如果设为true,在编辑文件保存的时候,编辑器会根据tsconfig.json的配置重新生成文件.(需要编辑器支持)filesfiles可以配置一个数组列表,里面包含指定文件的相对或绝对路径.编译器在编译ide时候只会编译包含在files中列出的文件.如果不指定,则取决于有没有设置include选项;如果没有include选项,则默认会编译根目录以及所有子目录的文件.这里列出的路径必须是指定文件,而不是某个文件夹,而且不能使用*、?、**/等通配符include指定要编译的路径列表，但和files的区别在于，这里的路径可以是文件夹，也可以是文件，可以使用相对和绝对路径，而且可以使用通配符.比如&quot;./src&quot;即表示要编译src文件夹下的所有文件以及子文件夹的文件.exclude表示要排除的、不编译的文件，它也可以指定一个列表，规则和include一样，可以是文件可以是文件夹,可以是相对路径或绝对路径，可以使用通配符.extends通过指定一个其它的tsconfig.json文件路径，来继承这个配置文件里的配置，继承来的文件配置会覆盖当前文件定义的配置.TS在3.2版本开始，支持继承一个来自Node.js包的tsconfig.json配置文件.compilerOptions包含很多可配置项,用来设置编译选项.target用于指定编译之后的版本目标,可选值有:ES3（默认值）、ES5、ES2015、ES2016、ES2017、ESNEXT.如果不配置,则默认使用ES3版本,如果设为ESNEXT,则使用最新的ES规范版本.module用于指定要使用的模块标准,可选值:commonjs、amd、system、umd、s2015(或写es6).如果不设置module选项,则判断target选项,如果target渲染设为ES6,则module默认为ES6,否则就是commonjslib用于指定要包含在编译中的库文件,如果你要使用一些ES6的新语法,则需要引入ES6/ES2015这个库,如果没有指定lib配置，默认会加载一些库，而加载什么库是受target影响的。如果target为ES5，默认包含的库有DOM、ES5和ScriptHost；如果target是ES6，默认引入的库有DOM、ES6、DOM.Iterable和ScriptHost.allowJsallowJs设置的值为true或false，用来指定是否允许编译JS文件，默认是false，即不编译JS文件.未完待续...","link":"https://blog.yguilai.com/post/oiRKwJIS-/"},{"title":"Typescript之泛型约束","content":"泛型约束就是使用一个类型和extends对泛型进行约束泛型约束例子:interfaceWithLength{length:number}constgetLength=&lt;TextendsWithLength&gt;(param:T):number=&gt;{returnparam.length}getLength(&quot;abcdefg&quot;)//7getLength([1,2,3])//3getLength({length:5})//5getLength(123)//error类型“123”的参数不能赋给类型“WithLength”的参数从上述例子可以看到,泛型变量T受到接口WithLenght的约束,不管它是什么类型,但必须有一个length属性.泛型约束中使用类型参数例子:constgetProp=(obj,propName)=&gt;{returnobj[propName]}constobj={a:'aaa',b:'bbb'}getProp(obj,'c')//undefined从上面这个例子可以看出,当获取这个对象的'c'属性时,就会得到undefined.这里我们就需要用到索引类型keyof结合泛型来实现对这个问题的检查constgetProp=&lt;T,KextendskeyofT&gt;(obj:T,propName:K)=&gt;{returnobj[propName]}constobj={a:'aaa',b:'bbb'}getProp(obj,'c')//类型“&quot;c&quot;”的参数不能赋给类型“&quot;a&quot;|&quot;b&quot;”的参数keyof可以理解为一个由泛型变量T的属性名构成的联合类型,因此K就被约束为了只能时'a'或'b',所传入字符串'c'时,ts就会检测出错误","link":"https://blog.yguilai.com/post/ZUto8nM6t/"},{"title":"Typescript之类型断言","content":"两种写法,一种是&lt;type&gt;value,一种是valueastype例子:constgetStrLength=(target:string|number):number=&gt;{if((&lt;string&gt;targer).length){//这种写法在jsx中不支持,同时也是tslint不建议的写法return(targetasstring).length//建议写法}else{returntarget.toString().length}}","link":"https://blog.yguilai.com/post/Zwy9o_K7j/"},{"title":"Typescript之ts补充的六个类型","content":"元组元组可以看作是数组的拓展,它表示已知的元素数量和类型的数组通过lettuple:[string,number,boolean]的方式定义各个位置上的元素类型都要对应,元素个数也要一致枚举ts在es原有类型鸡出上加入枚举类型Any程序有时是多变的,有时我们在编写代码时并不能清楚的知道一个值到底时什么类型,这个时候就需要用到any类型,eg:letdom:any=document.getElementById('myId')可以在定义数组类型时使用any来指定数组中的元素类型为任意类型不应该滥用any类型,如果任何值都指定为any类型,那么typescript就变成了&quot;anyscript&quot;😂voidvoid和any相反,any表示任意类型,void则是表示没有任意类型定义函数,没有返回值时常用到void类型的变量只能赋值为undefined和nullnervernever类型指那些永不存在的类型除它自身外,任何类型都不能赋值给never类型unknownunknown和any很像,但是unknown相对与any是安全的拓展类型交叉类型使用&amp;符号定义,被&amp;符号链接的多个类型构成一个交叉类型联合类型联合类型是要求是要符合联合类型中任意一种类型即可,使用|符号定义","link":"https://blog.yguilai.com/post/zpYjIzrB_/"},{"title":"yarn create react-app 报错文件名、目录名或卷标语法不正确","content":"最近学习react,看官方文档利用yarn新建项目运行yarncreatereact-appmy-app直接报错看网上解决办法很多都是修改create-react-app.cmd,然后添加环境变量,感觉很不优雅查了很多资料后,发现主要原因是我用npm全局安装的yarn,导致yarn的bin目录与安装目录在不同分区🙄查看yarn的bin目录yarnglobalbin查看yarn的安装目录yarnglobaldir这里是我已经修改了的,原来是在C盘如果发现bin目录与安装目录不在同一个分区,就将yarn的安装位置修改到同一分区yarnconfigsetglobal-folder&quot;D:\\Develop\\yarn\\global&quot;yarnconfigsetcache-folder&quot;D:\\Develop\\yarn\\cache&quot;再运行yarncreatereact-appmy-app可以发现已经搞定了👌","link":"https://blog.yguilai.com/post/x1hPVO9h_/"},{"title":"Win10解决无法调节屏幕亮度问题","content":"网上找了很多方法,如:重装集显驱动、修改注册表,都没用如果安装了TeamViewer,向日葵之类的远程控制软件,会自动安装监视器驱动解决办法:Win+R打开运行窗口,输入devmgmt.msc,回车打开设备管理器面板,找到监视器可以发现监视器驱动显示为PnP-Monitor(Standard)(厂商为TeamViewer)或者GenericMonitor(orayOPMS)(厂商为向日葵)右键选中对应驱动,打开属性&gt;驱动程序&gt;更新驱动程序&gt;浏览计算机以查找驱动程序软件&gt;从计算机的设备驱动程序列表中选取&gt;选中通用即插即用监视器,点击下一步安装即可,最好重启一下电脑","link":"https://blog.yguilai.com/post/TKVP2Etmw/"},{"title":"Go日志库Zap与lumberjack配置","content":"packagecoreimport(&quot;go-gin-api-example/core/global&quot;&quot;go.uber.org/zap&quot;&quot;go.uber.org/zap/zapcore&quot;&quot;gopkg.in/natefinch/lumberjack.v2&quot;&quot;os&quot;&quot;strings&quot;)funcinitZapLogger(){varlogger*zap.Loggercore:=zapcore.NewCore(newZapEncoder(),newWriteSyncer(),newZapLevel())//setinitializefieldsfield:=zap.Fields(zap.String(&quot;ApplicationName&quot;,global.CONFIG.App.Name))//judgecurrentenvironmentispro?ifglobal.CONFIG.App.Env!=&quot;pro&quot;{//enabledevmodecaller:=zap.AddCaller()development:=zap.Development()logger=zap.New(core,caller,development,field)}else{logger=zap.New(core,field)}//saveasaglobalvariableglobal.LOG=logger}funcnewWriteSyncer()zapcore.WriteSyncer{if!global.CONFIG.Log.EnableLogFile{returnzapcore.NewMultiWriteSyncer(zapcore.AddSync(os.Stdout))}else{logConfig:=global.CONFIG.Loghook:=lumberjack.Logger{Filename:logConfig.File.Path+string(os.PathSeparator)+global.CONFIG.App.Name+&quot;.log&quot;,MaxSize:logConfig.File.MaxSize,MaxBackups:logConfig.File.MaxBackups,MaxAge:logConfig.File.MaxAge,Compress:logConfig.File.Compress,}returnzapcore.NewMultiWriteSyncer(zapcore.AddSync(os.Stdout),zapcore.AddSync(&amp;hook))}}funcnewZapEncoder()zapcore.Encoder{encoderCfg:=zapcore.EncoderConfig{TimeKey:&quot;time&quot;,LevelKey:&quot;level&quot;,NameKey:&quot;logger&quot;,CallerKey:&quot;lineNum&quot;,MessageKey:&quot;msg&quot;,StacktraceKey:&quot;stacktrace&quot;,LineEnding:zapcore.DefaultLineEnding,EncodeLevel:zapcore.CapitalLevelEncoder,//大写编码器EncodeTime:zapcore.ISO8601TimeEncoder,//ISO8601UTC时间格式EncodeDuration:zapcore.SecondsDurationEncoder,EncodeCaller:zapcore.ShortCallerEncoder,//短路径编码器EncodeName:zapcore.FullNameEncoder,}ifglobal.CONFIG.Log.Encoder==&quot;json&quot;{returnzapcore.NewJSONEncoder(encoderCfg)}else{returnzapcore.NewConsoleEncoder(encoderCfg)}}funcnewZapLevel()zap.AtomicLevel{levelMap:=map[string]zapcore.Level{&quot;DEBUG&quot;:zap.DebugLevel,&quot;INFO&quot;:zap.InfoLevel,&quot;WARN&quot;:zap.WarnLevel,&quot;ERROR&quot;:zap.ErrorLevel,&quot;DPANIC&quot;:zap.DPanicLevel,&quot;PANIC&quot;:zap.PanicLevel,&quot;FATAL&quot;:zap.FatalLevel,}level:=zap.NewAtomicLevel()ifl,ok:=levelMap[strings.ToUpper(global.CONFIG.Log.Level)];ok{level.SetLevel(l)}else{level.SetLevel(zap.InfoLevel)}returnlevel}","link":"https://blog.yguilai.com/post/L_yuiYNgS/"},{"title":"ElementUI自定义上传 -以上传图标到七牛云为例","content":"解决ElementUI上传组件无法获取内部文件列表的缺陷&lt;template&gt;&lt;div&gt;&lt;el-uploadaction=&quot;#&quot;class=&quot;icon-uploader&quot;:auto-upload=&quot;false&quot;:on-change=&quot;onIcoUploadChange&quot;:show-file-list=&quot;false&quot;accept=&quot;image/*&quot;&gt;&lt;imgv-if=&quot;imageUrl!==''&quot;:src=&quot;imageUrl&quot;class=&quot;ico&quot;/&gt;&lt;iv-elseclass=&quot;el-icon-plus&quot;/&gt;&lt;divslot=&quot;tip&quot;class=&quot;el-upload__tip&quot;&gt;只能上传图片文件，且不超过200kb&lt;/div&gt;&lt;/el-upload&gt;&lt;el-button@click=&quot;upload()&quot;&gt;上传&lt;/el-button&gt;&lt;/div&gt;&lt;/template&gt;&lt;script&gt;exportdefault{data(){return{icoFile:null,imageUrl:'',qiniuToken:''}},methods:{//获取上传的文件对象onIcoUploadChange(file,fileList){this.icoFile=file//创建一个本地blob链接用于图片预览this.imageUrl=URL.createObjectURL(file.raw)},//上传文件到七牛asyncupload(){if(this.icoFile===null){this.$message.error('请先上传文件')return}//判断token是否为空if(this.qiniuToken===''){try{const{data}=awaitgetQiniuToken()this.qiniuToken=data}catch(err){this.$message.error(err.message)return}}letfileKey=''try{constformData=newFormData()formData.append('file',this.icoFile)formData.append('token',this.qiniuToken)const{key}=awaituploadImg2Qiniu(formData)fileKey=key//发送请求将key存到数据库//...}catch(err){this.$message.error(err.message)}}}}&lt;/script&gt;&lt;stylelang=&quot;scss&quot;scope&gt;$icoSize:64px;.icon-uploader.el-upload{width:$icoSize;height:$icoSize;position:relative;overflow:hidden;border:1pxdashed#d9d9d9;border-radius:6px;cursor:pointer;position:relative;overflow:hidden;&amp;:hover{border-color:#409eff;}}.icon-uploader.ico{width:$icoSize;height:$icoSize;}.icon-uploader.el-upload.el-icon-plus{width:$icoSize;height:$icoSize;font-size:20px;color:#8c939d;line-height:$icoSize;text-align:center;}&lt;/style&gt;获取token及上传图片importrequestfrom'@/utils/request'//获取后端生成的tokenexportfunctiongetQiniuToken(){returnrequest({url:'/qntoken',method:'GET'})}exportfunctionuploadImg2Qiniu(formdata){returnrequest({//该api从七牛获取,不同地域的存储桶对应api不同url:process.env.VUE_APP_QINIU_UPLOAD_API,method:'POST',headers:{'Content-Type':'multipart/form-data'},withCredentials:false,//禁止跨域携带cookie，带cookie在七牛上有可能出现跨域问题timeout:30000,data:formdata})}","link":"https://blog.yguilai.com/post/elementui-zi-ding-yi-shang-chuan-yi-shang-chuan-tu-biao-dao-qi-niu-yun-wei-li/"}]}